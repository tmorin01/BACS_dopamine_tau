setwd("~/Desktop/OSF/sup_fig07")
knitr::opts_chunk$set(echo = TRUE)
# Load Libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(lme4)
library(lmerTest)
# Set colorscales
jack_status_cscale <- scale_color_manual(values = c("#549e3e", "#323690", "#B6357B"))
jack_status_fscale <- scale_fill_manual(values = c("#549e3e", "#323690", "#B6357B"))
df <- read_csv('data_sup_fig07.csv')
df$tau_status <- factor(df$tau_status, levels = c('Younger\nAdults',
'Tau-', 'Tau+'))
figA <- df %>%
ggplot(aes(x = ftp_braak34_suvr, y = pos_index)) +
geom_point() +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
theme_classic() +
xlab(bquote('[18F]FTP SUVR\n(Braak III/IV Regions)')) +
ylab(bquote(atop('Positivity Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figA
View(figA)
View(df)
setwd("~/Desktop/OSF/sup_fig05")
knitr::opts_chunk$set(echo = TRUE)
# Load Libraries
library(tidyverse)
library(ggpubr)
library(lme4)
library(lmerTest)
library(rstatix)
# Set color scales
tau_group_cscale <- scale_color_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
tau_group_fscale <- scale_fill_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
age_group_cscale <- scale_color_manual(values = c("#643f95", "#549e3e"))
age_group_fscale <- scale_fill_manual(values = c("#643f95", "#549e3e"))
# Read data
data_A <- read_csv('data_sup_fig05a.csv')
data_B <- read_csv('data_sup_fig05b.csv')
data_A$tau_group <- factor(data_A$tau_group, levels = c('Low', 'Medium', 'High'))
data_B$tau_group <- factor(data_B$tau_group, levels = c('Low', 'Medium', 'High'))
# Panel A
figA <- data_A %>%
ggplot(aes(x=ftp_braak34_suvr, y=fmt_ki_vst)) +
geom_point(color = "#643f95", fill = "#643f95", alpha = 0.5) +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2, color = "#643f95") +
xlab('[18F]FTP (Braak 3/4 Regions)') +
ylab('[18F]FMT (Ventral Striatum)') +
theme_classic() +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
legend.position = 'bottom',
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 12),
axis.title.y = element_text(color = 'black', size = 12),
legend.title = element_blank(),
aspect.ratio = 1)
figA
modA <- lm(fmt_ki_vst ~ ftp_braak34_suvr + age + sex + yrs_edu,
data = data_A)
summary(modA)
# Panel B: Plot FMT by d' across each valence
figB <- data_B %>%
ggplot(aes(x = fmt_ki_vst, y = dprime, group = tau_group,
color = tau_group)) +
geom_point(alpha = 0.5) +
geom_smooth(aes(color = tau_group, fill = tau_group),
method = 'lm', linewidth = 2, limit = 0.9) +
tau_group_cscale +
tau_group_fscale +
theme_classic() +
xlab(bquote('[18F]FMT Ki\n(Ventral Striatum)')) +
ylab('d\'') +
facet_wrap(.~valence, nrow = 1) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
legend.position = 'bottom',
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 12),
axis.title.y = element_text(color = 'black', size = 12),
aspect.ratio = 1)
figB
View(data_B)
df <- read_csv('data_fig4bc.csv')
setwd("~/Desktop/OSF_old/00_organize_data")
df <- read_csv('data_fig4bc.csv')
ftp <- read_csv('sourcedata/anon_ftp.csv')
exclusions <- read_csv('sourcedata/anon_exclusions.csv')
ftp_groups <- read_csv('sourcedata/anon_ftp_groups.csv')
ftp <- merge(ftp, exclusions)
ftp <- ftp %>% filter(exclude_memory == 0)
View(ftp_groups)
#  Author: Tom Morin
#    Date: April, 2025
# Purpose: Organize data for sup. fig. 7
df <- read_csv('data_fig4bc.csv')
ftp <- read_csv('sourcedata/anon_ftp.csv')
exclusions <- read_csv('sourcedata/anon_exclusions.csv')
ftp_groups <- read_csv('sourcedata/anon_ftp_groups.csv')
ftp <- merge(ftp, exclusions)
ftp <- ftp %>% filter(exclude_memory == 0)
df <- merge(df, ftp, all = T)
df <- merge(df, ftp_groups, all = T)
df <- df %>% mutate(tau_status = case_when(age_group == 'Younger\nAdults' ~ 'Younger\nAdults',
ftp_braak2_wmean_exclbg_pvc < 1.26 ~ 'Tau-',
ftp_braak2_wmean_exclbg_pvc >= 1.26 ~ 'Tau+'))
df <- df %>% select(subject, age, sex, yrs_edu, age_group, biomarker_group,
pos_index, learning_RewVsLoss, fmt_ki_vst,
ftp_braak2_wmean_exclbg_pvc, ftp_braak2_wmean_exclbg_pvc_cat,
tau_status)
names(df) <- c('subject', 'age', 'sex', 'yrs_edu', 'age_group', 'biomarker_group',
'pos_index', 'learning_RewVsLoss', 'fmt_ki_vst', 'ftp_braak34_suvr',
'tau_group', 'tau_status')
write_csv(df, 'data_sup_fig07.csv')
View(df)
knitr::opts_chunk$set(echo = TRUE)
# Load Libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(lme4)
library(lmerTest)
# Set colorscales
jack_status_cscale <- scale_color_manual(values = c("#549e3e", "#323690", "#B6357B"))
jack_status_fscale <- scale_fill_manual(values = c("#549e3e", "#323690", "#B6357B"))
tau_group_cscale <- scale_color_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
tau_group_fscale <- scale_fill_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
df <- read_csv('data_sup_fig07.csv')
df$tau_status <- factor(df$tau_status, levels = c('Younger\nAdults',
'Tau-', 'Tau+'))
figA <- df %>%
ggplot(aes(x = ftp_braak34_suvr, y = pos_index)) +
geom_point() +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
theme_classic() +
xlab(bquote('[18F]FTP SUVR\n(Braak III/IV Regions)')) +
ylab(bquote(atop('Positivity Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figA
# Stats for Panel A
# Simplest model
lm1 <- lm(pos_index ~ ftp_braak34_suvr + age + sex + yrs_edu, data = df)
summary(lm1)
# Model accounting for learning accuracy
lm2 <- lm(pos_index ~ ftp_braak34_suvr + learning_RewVsLoss, data = df)
summary(lm2)
figB <- df %>% filter(!is.na(tau_group)) %>%
ggplot(aes(x = fmt_ki_vst, y = pos_index, group = tau_group,
color = tau_group, fill = tau_group)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
tau_group_cscale +
tau_group_fscale +
theme_classic() +
xlab(bquote('[18F]FMT Ki\n(Ventral Striatum)')) +
ylab(bquote(atop('Valence Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figB
knitr::opts_chunk$set(echo = TRUE)
# Load Libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(lme4)
library(lmerTest)
# Set colorscales
jack_status_cscale <- scale_color_manual(values = c("#549e3e", "#323690", "#B6357B"))
jack_status_fscale <- scale_fill_manual(values = c("#549e3e", "#323690", "#B6357B"))
tau_group_cscale <- scale_color_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
tau_group_fscale <- scale_fill_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
df <- read_csv('data_sup_fig07.csv')
df$tau_status <- factor(df$tau_status, levels = c('Younger\nAdults',
'Tau-', 'Tau+'))
df$tau_group <- factor(df$tau_group, levels = c('Low', 'Medium', 'High'))
figB <- df %>% filter(!is.na(tau_group)) %>%
ggplot(aes(x = fmt_ki_vst, y = pos_index, group = tau_group,
color = tau_group, fill = tau_group)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
tau_group_cscale +
tau_group_fscale +
theme_classic() +
xlab(bquote('[18F]FMT Ki\n(Ventral Striatum)')) +
ylab(bquote(atop('Valence Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figB
# Stats for Panel B
lm1 <- lm(pos_index ~ fmt_ki_vst*ftp_braak34_suvr + age + sex + yrs_edu,
data = df %>% filter(!is.na(ftp_braak34_suvr)))
summary(lm1)
# Model accounting for learning accuracy
lm2 <- lm(pos_index ~ fmt_ki_vst*ftp_braak34_suvr + age + sex + yrs_edu + learning_RewVsLoss,
data = df %>% filter(!is.na(ftp_braak34_suvr)))
summary(lm2)
pos_fig <- ggarrange(figA, figB,
ncol = 2,
labels = c('A', 'B'),
widths = c(0.6, 1))
ggsave(pos_fig, filename = 'sup_fig07.pdf', width = 6, height = 3, units = 'in')
pos_fig
pos_fig <- ggarrange(figA, figB,
ncol = 2,
labels = c('A', 'B'),
widths = c(0.6, 1))
ggsave(pos_fig, filename = 'sup_fig07.pdf', width = 6, height = 3, units = 'in')
pos_fig
setwd("~/Desktop/OSF/sup_fig07")
pos_fig <- ggarrange(figA, figB,
ncol = 2,
labels = c('A', 'B'),
widths = c(0.6, 1))
ggsave(pos_fig, filename = 'sup_fig07.pdf', width = 6, height = 3, units = 'in')
pos_fig
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Load Libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(lme4)
library(lmerTest)
# Set colorscales
jack_status_cscale <- scale_color_manual(values = c("#549e3e", "#323690", "#B6357B"))
jack_status_fscale <- scale_fill_manual(values = c("#549e3e", "#323690", "#B6357B"))
tau_group_cscale <- scale_color_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
tau_group_fscale <- scale_fill_manual(values = c("#4b9b7a", "#ca6728", "#7470af"))
df <- read_csv('data_sup_fig07.csv')
df$tau_status <- factor(df$tau_status, levels = c('Younger\nAdults',
'Tau-', 'Tau+'))
df$tau_group <- factor(df$tau_group, levels = c('Low', 'Medium', 'High'))
figA <- df %>%
ggplot(aes(x = ftp_braak34_suvr, y = pos_index)) +
geom_point() +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
theme_classic() +
xlab(bquote('[18F]FTP SUVR\n(Braak III/IV Regions)')) +
ylab(bquote(atop('Valence Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figA
# Stats for Panel A
# Simplest model
lm1 <- lm(pos_index ~ ftp_braak34_suvr + age + sex + yrs_edu, data = df)
summary(lm1)
# Model accounting for learning accuracy
lm2 <- lm(pos_index ~ ftp_braak34_suvr + learning_RewVsLoss, data = df)
summary(lm2)
figB <- df %>% filter(!is.na(tau_group)) %>%
ggplot(aes(x = fmt_ki_vst, y = pos_index, group = tau_group,
color = tau_group, fill = tau_group)) +
geom_point(alpha = 0.5) +
geom_smooth(method = 'lm', limit = 0.9, linewidth = 2) +
tau_group_cscale +
tau_group_fscale +
theme_classic() +
xlab(bquote('[18F]FMT Ki\n(Ventral Striatum)')) +
ylab(bquote(atop('Valence Index', (H[Rew] - H[Loss])/(H[Rew] + H[Loss])))) +
theme(panel.background = element_blank(),
axis.line = element_line(color = 'black'),
axis.text.x = element_text(color = 'black', size = 8),
axis.text.y = element_text(color = 'black', size = 8),
axis.title.x = element_text(color = 'black', size = 10),
axis.title.y = element_text(color = 'black', size = 10),
aspect.ratio = 1)
figB
# Stats for Panel B
lm1 <- lm(pos_index ~ fmt_ki_vst*ftp_braak34_suvr + age + sex + yrs_edu,
data = df %>% filter(!is.na(ftp_braak34_suvr)))
summary(lm1)
# Model accounting for learning accuracy
lm2 <- lm(pos_index ~ fmt_ki_vst*ftp_braak34_suvr + age + sex + yrs_edu + learning_RewVsLoss,
data = df %>% filter(!is.na(ftp_braak34_suvr)))
summary(lm2)
pos_fig <- ggarrange(figA, figB,
ncol = 2,
labels = c('A', 'B'),
widths = c(0.6, 1))
ggsave(pos_fig, filename = 'sup_fig07.pdf', width = 6, height = 3, units = 'in')
pos_fig
